var background=(function(){"use strict";function u(r){return r==null||typeof r=="function"?{main:r}:r}const l=u(()=>{chrome.runtime.onMessage.addListener((r,a,n)=>{if(!r||r.type!=="CQD_DOWNLOAD")return;const t=r.url;if(typeof t!="string"||!/^https?:\/\//i.test(t)){n({ok:!1,error:"Invalid URL"});return}if(!chrome.downloads||typeof chrome.downloads.download!="function"){n({ok:!1,error:"chrome.downloads API not available"});return}return chrome.downloads.download({url:t},c=>{const i=chrome.runtime.lastError;if(i){console.warn("[CQD] chrome.downloads.download error:",i.message),n({ok:!1,error:i.message});return}n({ok:!0,id:c})}),!0})});function d(){}globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome;function o(r,...a){}const s={debug:(...r)=>o(console.debug,...r),log:(...r)=>o(console.log,...r),warn:(...r)=>o(console.warn,...r),error:(...r)=>o(console.error,...r)};let e;try{e=l.main(),e instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(r){throw s.error("The background crashed on startup!"),r}return e})();
